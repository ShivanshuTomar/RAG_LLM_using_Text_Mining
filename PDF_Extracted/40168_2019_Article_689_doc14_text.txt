# Heinken et al. Microbiome (2019) 7:75

# Page 15 of 18

cytoplasmic and extracellular, have been shown in Lactobacillus acidophilus, Lactobacillus bulgaricus, and Lactobacillus casei [73]. The precise mechanisms of these reactions as well as the enzyme-encoding genes are unknown, but the biotransformation has been shown to be associated with the oxidation of NADH to NAD+ [73]. Consequently, reactions for extracellular and cytoplasmic NADH-dependent reduction of cholesterol to coprostanol were added to six Lactobacillus sp. models, together with exchange reactions for cholesterol and coprostanol as well as a predicted transport reaction for cholesterol uptake.

All metabolites and reactions were formulated following an established reconstruction protocol [8]. Metabolites and reaction abbreviations in the bile acid subsystem were created in accordance with the Virtual Metabolic Human (VMH) [16] nomenclature to ensure compatibility with the human metabolic reconstruction. The MATLAB-based reconstruction tool rBioNet [74], which ensures quality control and quality assurance, such as mass- and charge-balance, was used to add the metabolites and reactions to the appropriate reconstructions. All reactions and metabolites in the reconstructed bile acid subsystem are described in Additional file 1: Table S2a, b.

# Expansion of AGORA

A total of 46 gut microbial strains were newly reconstructed. The reconstructions were generated by semi-automatically expanding and curating KBase [75] draft reconstructions following the established AGORA pipeline used in [15] (Additional file 1: Table S11). Of the 773 AGORA strains and 46 newly reconstructed strains, 232 strains total carried at least one gene in the bile acid pathway (Additional file 1: Table S1) and six produced coprostanol. The corresponding reconstructions were expanded by the appropriate metabolites and reactions using rBioNet [74] and subjected to extensive quality-assurance and control measures [8, 32] (Fig. 1a). The expanded resource, accounting for 818 strains, is available on the Virtual Metabolic Human website [16].

# Construction of pairwise models

The 232 AGORA reconstructions carrying bile acid reactions were joined pairwise in every possible combination as described previously [15] using the Microbiome Modeling Toolbox [33]. In total, 26,796 pairwise models were created. Illumina raw reads of 33 dysbiotic Crohn’s Disease patients in the PLEASE cohort [36] and of 26 healthy controls in the COMBO cohort [37] were retrieved from NCBI SRA under SRA: SRP057027. For the latter dataset, the reads had been pre-processed and then mapped onto the reference set of 773 AGORA genomes, as described in [38]. To reduce the number of false positives, a cutoff of 10% genome coverage was applied to the resulting coverages (representing a threshold of at least 10% genome coverage for each microbe in each human individual). The resulting coverages were normalized for each individual in order to obtain the relative abundances. To avoid too small model sizes, microbiome models, for which less than 20 strains could be mapped to the reference set of AGORA genomes, were excluded from the analysis. This was the case for 13 samples from the PLEASE cohort and one sample from the COMBO cohort.

Personalized microbiome models were then created using the mgPipe module in the Microbiome Modeling Toolbox [33] (Fig. 1b). Briefly, for all strains identified in at least one metagenomics sample, the corresponding AGORA reconstructions, if available, were joined into one global constraint-based microbiome community reconstruction as described elsewhere [17, 33]. For each of the 194 metagenomic samples, the list of all the mapped strains and their strain-level abundances served as input data for deriving a personalized microbiota model from the global community reconstruction, which consisted of the joined AGORA reconstructions corresponding to each strain present in the sample. The flux through each AGORA strain’s model was coupled to its respective biomass objective function, as described elsewhere [11]. Then, we parameterized the community biomass reaction by applying the strain-level abundances as stoichiometric values for each microbe biomass reaction in the community biomass reaction (Fig. 1b). These constraints enforced that all strains grew at the experimentally measured ratios. Subsequently, an Average European diet supplemented with conjugated primary bile acids (see below) was applied as constraints on the dietary exchanges. To simulate a realistic turnover of microbial biomass, the allowed flux through the community biomass reaction was set to be between 0.4 and 1 mmol × person-1 × day -1, corresponding to a fecal emptying of once every three days to once a day. The features of the personalized community models are given in Table 2.

# Construction of sample-specific gut microbiota models

Metagenomic datasets from 194 samples in total were obtained from three sources: (1) Strain-specific relative abundance data from 149 individual microbiotas of healthy American individuals was obtained from the Human Microbiome Project website [35]. (2) Paired-end

# Definition of the average European diet

A diet representing the nutrient intake of an average European individual was obtained from the nutrition resource in the Virtual Metabolic Human database [16] along with the corresponding flux values. The diet was supplemented with metabolites previously determined.