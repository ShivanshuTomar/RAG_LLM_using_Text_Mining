# Abbas-Egbariya et al. Genome Biology (2022) 23:61

# Page 20 of 23

NSDI(S) = log2(∑i∈down_nonspecifics si • | down_nonspecific |) / | up_nonspecific |

where NSDI(S) is the non-specific dysbiosis index of sample S, and up_nonspecific and down_nonspecific represent the group of disease nonspecific ASVs higher and lower in cases vs. controls respectively, as described in the paper.

The taxonomy based dysbiosis index was calculated following the method described in [2], implemented for the denoised data using the taxonomy assigned to each ASV:

DTAX(S) = log2(∑i∈up_taxonomies si) / (∑i∈down_taxonomies si)

where up_taxonomies, down_taxonomies are the lists of taxonomies identified as higher and lower in Crohn’s disease, as listed in [2].

For the performance evaluation, we used a leave-one-out approach. We iterated over all disease cohorts and for each iteration performed the analysis while leaving out a single validation disease cohort. The up_nonspecific, down_nonspecific ASV groups were identified as described above (see the “Identification of shared (“non-specific”) ASVs” section) but without the validation cohort (i.e., the non-specific ASVs were identified based on 58 disease cohorts). The dysbiosis index was then calculated for all samples of the validation cohort, and the p-value (for the null hypothesis of similar dysbiosis index distribution for cases and controls in the validation cohort) was tested using the non-parametric Mann-Whitney test with the single sided hypothesis (cases > controls).

# Data and code availability

Accession numbers for all studies used in the analysis are available in Additional file 1: supplementary table S1.

Commands and Scripts used for the generation of the per-study biom table and code are available in the sites Github and zenodo [41, 64].

# Supplementary Information

The online version contains supplementary material available at https://doi.org/10.1186/s13059-022-02637-7.

# Additional file 1:

Supplementary Table. Accession numbers for the studies used in the meta-analyses.

- Figure S1. The pipeline used for microbial characterization in our study overcomes cohort specific determinants and enables comparisons between disease cohorts.
- Figure S2. Non-specific microbial signal shared across diseases after rarefaction, and after using Lefse LDA.
- Figure S3. Prediction of the non-specific KEGG ontologies microbial signal shared across diseases.
- Figure S4. Disease classifier fails to predict control and disease samples when shuffling the samples before prediction.
- Figure S5. Dysbiosis index using UniDI and CD dysbiosis index.
- Figure S6. Dysbiosis index generated by the per-sample rank method (UniDI) showed more significant values between case/control samples.

# Additional file 2:

Dataset S1. Non-specific ASVs signal (separate excel file) using initial NRMD, rarified NRMD (to 4K reads/sample), and LEFSE LDA.

# Additional file 3:

Dataset S2. Per-ASV prediction of KEGG functions (PICRUSt2) significantly higher (or lower) in disease-associated non-specific bacteria.

# Additional file 4:

Dataset S3. IBD-specific ASVs.

# Additional file 5:

Review history.