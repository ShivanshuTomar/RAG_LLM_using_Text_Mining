# Heinken et al. Microbiome (2019) 7:75

given medium conditions (i.e., diet). Second, the metabolic reconstructions used in our approach are strain-resolved, and the capabilities included in each metabolic network are based on the microbes’ genome, detailed comparative genomic analyses as well as an extensive review of the literature for biochemical and physiological data [15]. As a consequence, the metabolic contribution of each strain in each individual microbiome can be exactly predicted with high confidence. Another advantage of our approach is the incorporation of species-species boundaries and transport capabilities. As stated above, species-species cross-feeding plays a key role for the metabolic potential of a microbial community and thus needs to be considered. Finally, it is challenging to link typical metagenomics-based approaches to a particular host function. Microbial species or functions can be correlated with certain host metabolites through top-down multivariate statistical analyses [50]. However, mechanisms explaining these correlations are often lacking. As more omics data become available for microbiome samples, the generated microbiome models can be further constrained and personalized through the integration of meta-transcriptomic [51], meta-metabolomic [52], meta-proteomic data [53], or nutritional information via the Virtual Metabolic Human database [16]. The microbiome models can also be integrated with the global human reconstruction, Recon3D, which includes a secondary bile detoxification subsystem [54], or with the whole-body organ-resolved reconstruction of human metabolism [19] thanks to the use of a consistent namespace [15]. The integrated analysis can predict organ-specific metabolic changes due to differences in microbial community composition and yield novel hypotheses about host-microbiome co-metabolism [19].

One limitation of the method is the steady-state assumption of flux balance analysis and the resulting computation of fluxes rather than concentrations. Moreover, the AGORA reconstructions and our modeling framework do not include regulatory constraints and kinetic parameters. As a result, the modeling framework does not account for substrate specificity and transporter capacity, although the latter could be incorporated as reaction constraints dependent on data availability. This limitation could be overcome using hybrid modeling techniques that integrate the dynamics and the regulation of biochemical processes through with differential equations [55–58]. Furthermore, our method does not allow predicting microbial composition or organismal abundances in the microbiome, again due to the steady-state assumption. The method relies on parameterizing the personalized models with the relative microbial abundances calculated from the metagenomic data. For predicting microbial abundances, dynamic community flux balance analysis methods [58, 59] are more appropriate. Consequently, we focus the application of our framework on exploring the metabolic profile of a given gut microbiome with known microbial composition. Finally, it is well known that the gut microbiome fluctuates over time [60], however, each simulation performed with the personalized models only represents the fecal microbiome at a single time point. This is expected as the fecal metagenomic sample that serves as the input data also only captures the gut microbiome at a single time point. Fecal metagenomic samples from the same individuals at multiple time points are, for example, available in [61]. Such data could be used to model a time series of metabolic states and elucidate how the gut microbial metabolic profiles fluctuate over time.

Flux profiles predicted by the framework can be readily compared with qualitative increases or decreases in metabolites in disease conditions to validate simulation results, which would require metagenomic or 16S rRNA data as well as fecal metabolomics from the same subjects. Metagenomic and fecal metabolomic measurements of bile acids have been performed in [62] and such data could be linked through modeling in future efforts. Such comparisons have valuable applications for mechanistically linking metagenomic and metabolomic measurements from the same sample. Moreover, qualitative and quantitative metabolomic data could be used as input data to contextualize the models further. A COBRA Toolbox module for the implementation of metabolomic data with constraint-based models has been developed [52].

While the scope of the present work is the prediction of bile acid metabolism, in future efforts, other health-relevant microbial metabolic subsystems may be considered. For instance, Lewis et al. found that several pathways, e.g., glycerophospholipid metabolism, amino benzoate degradation, sulfur relay system, and glutathione metabolism, separated healthy and dysbiotic microbiomes [36]. In a follow-up work, fecal amino acid levels have been found to be altered in IBD patients and to positively correlate with Proteobacteria [40]. Applying the computational workflow presented in this study to predict the gut microbial metabolome beyond bile acid metabolism would allow us to mechanistically link altered metabolites with strain-specific capabilities. Ultimately, such analysis could lead to novel insights into the mechanisms behind altered metabolomes in disease states and allow pinpointing disease-relevant species and/or enzymes that may serve as novel drug targets.

# Conclusions

We demonstrated that an in silico metabolic modeling workflow could elucidate the metabolic potential of an individual’s microbiome, which cannot be done based on