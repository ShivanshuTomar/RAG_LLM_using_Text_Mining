# Molecular Systems Biology

# Amrisha Bhosle et al

minClusterSize of 21 (∛9280). The 9280 features were distributed among 210 modules and 132 singletons. For the 1311 metabolites common in both MS1 and MS2 datasets, similarity between the GNPS and MACARRoN cluster assignments (instances whether a pair of features had the same GNPS cluster ID and MACARRoN module ID) was calculated using adjusted Rand Index (ARI) with the mclust (Scrucca et al, 2016) R package. To test whether the overlap between GNPS and MACARRoN was non-random, MACARRoN module assignments were shuffled (×1000) and compared to GNPS (and vice versa ×1000) and ARI was determined for each comparison. Actual ARI and ARI from randomized-assignments were compared using a one-sample t test.

# Analyzing mass-differences in annotated-modules

The m/z values of all features were rounded off to the first decimal. The mass-differences (Δm/zs) between all pairs of unannotated metabolic features and co-clustered standards in each annotated module (M) were calculated as:

Δm/z = m/zunannotated - m/zstandard

metabolomes (Dataset EV9). For each dataset, a molecular network was created using the default online workflow (https://ccms-ucsd.github.io/GNPSDocumentation/) on the GNPS website (http://gnps.ucsd.edu). The data was filtered by removing all MS2 fragment ions within +/− 17 Da of the precursor m/z. MS2 spectra were window-filtered by choosing only the top six fragment ions in the +/− 50 Da window throughout the spectrum. The precursor ion mass tolerance was set to 2.0 Da and a MS/MS fragment ion tolerance of 0.5 Da. A network was then created where edges were filtered to have a cosine score above 0.7 and more than 6 matched peaks. Further, edges between two nodes were kept in the network if and only if each of the nodes appeared in each other’s respective top 10 most similar nodes. Finally, the maximum size of a molecular family was set to 100, and the lowest-scoring edges were removed from molecular families until the molecular family size was below this threshold. The spectra in the network were then searched against GNPS’ spectral libraries. The library spectra were filtered in the same manner as the input data. All matches kept between network spectra and library spectra were required to have a cosine score above 0.7 and at least 6 matched peaks.

# Distribution of Δm/zs in real versus random annotated-modules

Identifying matches between features in modules 10 and 85 and stercobilin molecular networks. Of the molecular networks identified for each of the 11 MassIVE datasets, those containing features annotated as stercobilin were selected. Then, features that were directly connected to stercobilin and within Δm/z of 100 w.r.t to it were considered. If the stercobilin molecular networks contained a feature(s) annotated as urobilin, its neighbors satisfying the aforementioned criteria were also considered. The m/zs of these features were then compared to the m/zs of highly prioritized features in modules 10 and 85 that were within Δm/z of 100 of stercobilin.

This was repeated 1000 times, and then each of the 1000 Δm/z distributions was compared to the distribution obtained from actual modules using the Kolmogorov–Smirnov test.

# Enrichment of Δm/zs in real versus random modules

Another evaluation criterion we applied to the resulting modules was the distribution of Δm/zs, which we would expect to be enriched for small positive (and occasionally negative) deltas when they represent the addition (or removal) of functional groups from a parent backbone. In order to inspect these distributions, we grouped Δm/zs by one-unit bins for ease of analysis. Each bin’s frequency was calculated, and all Δm/z bins observed more than once were considered. In total, this yielded 694 positive and 499 negative Δm/z bins. As described before, random modules were generated by shuffling labels, and the frequency of each of the 1193 Δm/z bins was noted. This was repeated 10,000 times. An empirical P value of enrichment for each Δm/z bin was calculated as (North et al, 2002):

p = (r + 1) / (n + 1)

where n is the total number of iterations i.e., 10,000, and r is the number of iterations in which the frequency of the Δm/z bin was greater than or equal to that calculated from the real modules.

# Confirmation of prioritized bilirubin/stercobilin pathway members

from modules 10 and 85 in MassIVE molecular networks. In support of MACARRoN’s predicted bilirubin pathway derivatives, we identified 11 MassIVE datasets corresponding to MS2 analysis of human stool.

# Host vs. microbial NAD enzyme activity in NR metabolism

Differential abundance of microbial NAD biosynthesis enzymes in IBD. Perturbation statuses of nadA and nadB (de novo) and nadR, pncA, and pncB (salvage) protein families (UniRef90) were obtained from a previous study (Zhang et al, 2022). Briefly, abundances of each protein family were estimated from 1595 metagenomes from 130 participants in HMP2 (CD, n = 65; UC, n = 38; non-IBD, n = 27) using MetaWIBELE v0.3.8. The abundance values were normalized to copies per million (CPM) units and log-transformed. Zero values were additively smoothed by half of the smallest non-zero measurement on a per-feature basis. The same random effects model formulation applied to HMP2 metabolomics was applied here within MaAsLin 2 (Mallick et al, 2021), which estimated the differential abundance of each protein family in dysbiotic (active) versus non-dysbiotic CD and UC.

# Transcription of host NAD biosynthesis enzymes

The host transcriptomes (HTX) from the HMP2 dataset were downloaded from http://ibdmdb.org in July 2020. To match HTX samples with MBX samples, we considered the first pair of MBX:HTX samples from each subject that were separated by no more than 2 weeks (yielding 71 HTX samples from 71 individuals: 33 with CD, 21 with UC, and 17 non-IBD controls). We performed normalization on raw sample-by-gene count data of the selected HTX samples using the voom method implemented in R’s limma package (Law et al, 2014).

© The Author(s)

354 Molecular Systems Biology Volume 20 | Issue 4 | April 2024 | 338 – 361