# Knights et al. Genome Medicine 2014, 6:107

# Statistical analysis

Linear association tests were performed only within those taxa with nonzero abundance in at least 75% of subjects. Taxa below that threshold were subjected to logistic regression for presence/absence; no such taxa revealed significant associations after correcting for multiple comparisons. To ensure robustness of tests to outliers, subjects with taxon or functional module relative abundance more than three times the interquartile range from the mean were excluded for tests of that feature. Power analysis was performed using the linear effect size that we observed for Enterobacteriaceae when regressing on controlling linearly for clinical covariates (f2 = R/(1 - R2) = NOD2 risk allele count and 0.013; R is the coefficient of multiple correlation). Assuming the need to correct for testing of all 163 IBD loci against 22 dominant taxa (3,586 tests; adjusted significance threshold = 1.39 × 10-5), we would need at least 3,729 samples to power the full analysis (R ‘pwr’ package power calculation for a linear model with 19 numerator degrees of freedom). Discrete qualitative covariates were re-coded with dichotomous dummy variables representing each class prior to testing. Association of clinical covariates was performed jointly by multiple linear regression. To overcome redundancy between clinical covariates, we clustered clinical covariates based on their pairwise maximum uncertainty coefficients, an information-theoretic measure of their degrees of shared information. Continuous-valued covariates were discretized prior to information-theoretic clustering. Complete-linkage clustering was performed to identify groups of covariates in which each covariate contained at least 50% of the information contained in each other covariate. Network plots were created using the igraph package. For the network plot of non-genetic host factors and NOD2, width of edges was determined by the ratio of a given covariate’s linear regression coefficient to the mean of the regressed taxon’s relative abundance. Enrichment of a host functional pathway for association with bacterial taxa was assessed by comparing the observed rank product of all host gene-bacterial taxon association tests for all genes in the pathway with the distribution of rank products of 100,000 size-matched pathways randomly generated from the null Immunochip variants described above. Prior to testing, REACTOME pathways with >75% overlap were binned and the largest constituent pathway chosen as a representative for subsequent tests.

# Results and discussion

# Genotype-microbiome associations conserved across independent cohorts

Our genotype-microbiome association testing methodology included steps to overcome power limitations given the very large number of potential comparisons, to incorporate published knowledge of signaling and metabolic pathways in the host genome, and to control for multiple environmental host factors affecting gut microbiome composition. In a targeted analysis of NOD2, we also accounted for multiple causal variants in the genetic locus. After data preprocessing and normalization we tested linearly for association of risk allele count in each SNP with the relative abundance of each bacterial taxon. In all tests, we controlled for recent antibiotic usage (<1 month), recent immunosuppressant usage (<1 month), biopsy inflammation status based on pathology, age, gender, biopsy location, CD/UC diagnosis, disease location, elapsed time since diagnosis, cohort membership, and the first three principal components of genotype variation. Although the IBD-related SNPs extracted from the Immunochip data were identified previously in European populations, we do not expect this to limit our findings because our cohorts were mostly of European descent. We validated our linear testing methodology by comparing associations in the Boston cohort with those in the other two cohorts, in addition to performing other sensitivity analyses.

We tested 163 recently IBD-associated SNPs for association with bacterial taxonomic profiles; 154 remained after removing those with low minor allele frequencies or with low call rates in our cohorts. Many of these SNPs have unknown mechanisms and are likely only representative of a signal within the surrounding genomic locus. Therefore, when a single gene was associated previously with a SNP, we refer to that SNP by the gene name for convenience. Due to limited statistical power we were unable to perform a full analysis of all possible SNP-taxon associations. However, we were able to test for the robustness of microbiome-wide associations with a given SNP by comparing the directionality of the SNP-taxon coefficients between independent cohorts. For this test we included only those SNP-taxon associations for a given SNP that were nominally significant (P < 0.05) in at least one of the studies being compared. We then obtained Matthew’s correlation coefficient (MCC; also known as the phi coefficient) of the signs (positive or negative) of the SNP-taxon coefficients in one study with the signs of corresponding SNP-taxon coefficients in the second study, and corrected these microbiome-wide tests for multiple comparisons (one MCC test per gene) at a false discovery rate (FDR) of 0.25.