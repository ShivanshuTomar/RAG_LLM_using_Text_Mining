# Heinken et al. Microbiome (2019) 7:75

gene count and reaction abundance alone. We illustrated this workflow using metagenomics data of healthy individuals and IBD patients while focusing on bile acid metabolism. Importantly, we were able to demonstrate that this mechanistic, strain- and metabolite-resolved, unbiased, and inexpensive approach allows for the systematic interrogation of the metabolic potential of an individual’s microbiome and can yield testable novel hypotheses. Integrative systems biology approaches are urgently needed to gain novel insight into complex, multifactorial diseases, such as IBD [1]. In future efforts, personalized modeling could also be applied to predicting individual-specific dietary or therapeutic interventions [63]. The AGORA resource, the COBRA Toolbox, and the Microbiome Modeling Toolbox are freely available to the scientific community. We have also created extensive tutorials (available at the COBRA Toolbox GitHub) aiding users interested in applying our framework. We expect that the metabolic modeling approach presented will have valuable applications in unraveling the role of human-gut microbiome metabolic interactions in human health and disease.

# Materials and methods

# Comparative genomic approach

All 773 strains of the AGORA resource [15], 46 strains reconstructed in this study, and 23 currently not reconstructed strains were analyzed for the presence of their genomes at the PubSEED resource [26, 27], resulting in 690 bacterial and three archaeal genomes to be considered in this study (Fig. 1a). Note that only 670 of the reconstructed microbes had their genomes available in PubSEED and were consequently used for the comparative genomic approach. All 693 human gut microbe genomes were analyzed for the presence of orthologs of bile acid deconjugation and biotransformation genes (Additional file 1: Table S1). Orthologs are defined as genes that satisfy the following conditions: (1) Orthologs should be closely homologous proteins (e-value cutoff = e−50). (2) Orthologs should be found in the same genomic context, i.e., the structure of gene locus should be conserved in related genomes. (3) Orthologs should form a monophyletic branch of a phylogenetic tree.

For the search of homologs and analysis of genomic context, the PubSEED platform was used along with phylogenetic trees for protein domains in MicrobesOnline [64]. Multiple protein alignments were performed using the MUSCLE v. 3.8.31 tool [65, 66]. Phylogenetic trees were constructed using the maximum-likelihood method with the default parameters implemented in PhyML-3.0 [67]. The obtained trees were visualized and midpoint-rooted using the interactive viewer Dendroscope, version 3.2.10, build 19 [68].

The following previously analyzed genes were used as a starting point: (1) genes for bile salt BSH from multiple genomes [21], (2) 7α–HSDH from Bacteroides fragilis [22], (3) 3α- and 3β-HSDHs genes from Eggerthella lenta DSM 2243 and Ruminococcus gnavus ATCC 29149 [23], (4) 7α-HSDH and baiABCDEFGHI genes for a multistep 7α/β-dehydroxylation pathway, (5) bai genes from Eggerthella lenta DSM [23], (6) 7β-HSDH gene from Clostridium absonum [25], and (7) 12α-HSDH from Clostridium hylemonae DSM 15053, Clostridium scindens ATCC 35704, and Clostridium hiranonis DSM 13275 [24]. Note that Clostridium leptum has been experimentally shown to have 12α-HSDH activity [28]; however, we were unable to identify the 12α-HSDH gene in its genome. BSH proteins are closely related to the penicillin V amidase (PVA) proteins [21]. To avoid mis-annotations, a phylogenetic tree for BSH proteins and their homologs in the analyzed genomes was constructed (Additional file 2: Figure S1), and orthologs of the known BSH genes were identified. All HSDH proteins listed above demonstrated similarity to each other and with BaiA proteins. Thus, orthologs for HSDH/BaiA proteins were resolved through the construction of a phylogenetic tree (Additional file 2: Figure S2). Finally, two new genes in the 7α/β-dehydroxylation pathway (BaiO and BaiP, Fig. 2) were predicted in this work. All of the annotated genes are represented as a subsystem at the PubSEED website [69] and can be found in Additional file 1: Table S1.

# Formulation and addition of reactions

Reaction mechanisms were retrieved from the KEGG database [70] as well as published literature (e.g., [71]). For all genomes having genes for BSH, HSDHs, or the complete 7α/β-dehydroxylation pathway (Fig. 2), metabolic mass- and charge-balanced reactions were formulated. Exchange reactions were added for all extracellular metabolites. Most reactions were associated with genes and proteins annotated in the analyzed genomes. Reactions not associated with genes and proteins were only added if the gene was unknown but the reaction was required to eliminate dead-ends in a metabolic pathway. Thus, the following gap-filling reactions were added without associations with genes or proteins: (1) A transport reaction for LCA, the final product of 7α/β-dehydroxylation pathway which was added as the transporter is unknown. (2) Pathways that yield allolithocholate (allo-LCA) and allodeoxycholate (allo-DCA) were included for strains possessing the bai gene cluster as these compounds are known to be side-products of the 7α/β-dehydroxylation pathway [72] and found in human adults under certain circumstances [3].

Pathways for cholesterol reduction to coprostanol were also reconstructed. These enzymatic activities, both