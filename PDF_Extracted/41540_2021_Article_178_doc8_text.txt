# A. Heinken et al.

The oral administration of chondroitin sulfate was already shown to be effective in IBD in a small clinical trial42. While the authors of study recently demonstrated that fluxes generated through the same microbiome modelling approach could be directly correlated with raw faecal metabolomic data and showed a very good agreement45.

The study attributed this effect to the general anti-inflammatory properties of chondroitin sulfate42,43, one may speculate that chondroitin sulfate is a prebiotic, promoting the growth of glycan-degrading species. Thus, promoting glycan degraders may improve species diversity, subsequently metabolic diversity, and may decrease by proxy the production of harmful microbial metabolites (e.g., hydrogen sulfide). A previous metabolic modelling approach already predicted dietary metabolites that could improve short-chain fatty acid secretion profiles in IBD20. Here, we additionally propose a mechanistic explanation for potentially beneficial dietary interventions.

In conclusion, by computational modelling of microbial communities, we identified a potentially beneficial intervention on gut microbiota in IBD, which could be applied in a personalised manner in IBD cases specifically lacking glycan-degrading species. This underlines the utility of analysing the metabolic capabilities of microbial communities with mechanistic, strain-and molecule-resolved modelling tools.

Through computational modelling of IBD microbiomes, we could contextualise metabolomic findings. While one cannot compare fluxes and concentrations44, the trends of upregulated and downregulated metabolites in the dysbiotic cluster can nonetheless be compared. Indeed, for 16 of 23 amino acid metabolites, in silico fluxes agreed with measured faecal concentrations (Supplementary Table 7). While this agreement narrowly failed to be significant, it points towards the utility of COBRA modelling in predicting real metabolomic changes in IBD. Larger samples are needed to corroborate these results. Note that the ability to predict in vivo changes is dependent on the sample size utilised to reveal significant in vivo changes. In fact, in a similar constraint-based modelling approach using data from over 600 colorectal cancer patients and controls, good agreement between model predictions and faecal metabolomic measurements has been found45.

# METHODS

# Creation of personalised models

Paired end Illumina raw reads of 83 IBD patients in the PLEASE cohort8 and of 25 healthy controls in the COMBO cohort51 had been previously retrieved from NCBI SRA under SRA: SRP05702720. The reads had been preprocessed and mapped onto the reference set of AGORA genomes20. Publicly available metadata for the samples was retrieved from https://github.com/chvlyl/PLEASE and the sample stratification into the groups control, cluster 1 (non-dysbiotic IBD), and cluster 2 (dysbiotic IBD) was adapted as defined by the original authors8.

Personalised models for the 108 samples were created using Version 1.03 (published on 25.02.2019, available at https://www.vmh.life) of the AGORA resource18. To build the personalised models, the COBRA Toolbox52 extension Microbiome Modelling Toolbox14 was used. Personalised microbiome models were created in MATLAB (Mathworks, Inc.) version R2018b using the mgPipe module, as described previously24. Each personalised model contained a community biomass reaction, which was parameterised by applying the strain-level abundances as stoichiometric values for each microbe biomass reaction in the community biomass reaction. These constraints enforced that all strains grew at the experimentally measured ratios.

The models were further contextualised as follows: To simulate a realistic intake of dietary nutrients in mmol per g dry weight per hour in the 108 microbiome models, an Average European diet was retrieved from the Diet Designer resource on the Virtual Metabolic Human17 website (https://www.vmh.life). The diet was converted to uptake fluxes through a dedicated Microbiome Modelling Toolbox function (convertVMHDiet2AGORA.m). Moreover, to account for host metabolism, the uptake of metabolites of host origin known to be present in the intestine (e.g., primary bile acids, host glycans) were allowed using standard COBRA Toolbox functions52. Finally, to simulate a realistic turnover of microbial biomass, the allowed flux through the community biomass reaction was set to be between 0.4 and 1 (mmol/person/day), corresponding to a faecal emptying of once every three days to once a day.

# Prediction of metabolic profiles

Absolute reaction presence and reaction abundances on the total community, phylum, and genus level were calculated in MATLAB using dedicated Microbiome Modelling Toolbox functions (calculateReactionPresence.m, calculateReactionAbundance.m). The computation of the total community metabolite production potential, total community metabolite uptake potential, and the contribution of each strain to each metabolite was performed in Julia53 using the implementation of flux analysis, COBRA.jl. COBRA.jl was performed on a high-performance cluster using the IBM CPLEX solver (IBM, Inc.) through the CPLEX interface for Julia. A customised Julia script was used that retrieved all dietary exchange reactions, faecal secretion reactions, and strain-specific internal exchange reactions for each microbiome model. This resulted on average in 13,677 exchange reactions per microbiome model, which were then each minimised and maximised.

Published in partnership with the Systems Biology Institute npj Systems Biology and Applications (2021) 19