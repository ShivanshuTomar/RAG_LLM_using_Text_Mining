# Ma et al. Genome Biology (2022) 23:208

# Continuous structure discovery

Continuous structure discovery was performed with MMUPHin’s corresponding component (MMUPHin_Continuous). The four largest studies (CS-PRISM, Pouchitis, PROTECT, RISK) were subsetted to baseline samples (only relevant for PROTECT), stratified by CD/UC and biopsy/stool sample type, and used as the training sets for MMUPHin_Continuous. The minimum variance explained threshold (threshold) was set to default (80%), but we varied the PC similarity (evaluated by absolute cosine coefficient) cutoff thresholds between 0.5 and 0.8 to assess the sensitivity of the two identified PC clusters in Fig. 5b (corresponding to thresholds = 0.65). As we show in Additional file 1: Fig. S14, with a small threshold (0.5) PC networks become denser, with the two PC clusters in Fig. 4b forming key components of two larger clusters; when thresholds is large (0.8), the network is sparser, with only the most highly similar nodes of the two clusters forming smaller communities. We thus concluded that the two identified clusters in Fig. 5b were not sensitive to the cosine coefficient threshold, as they were recurrently identified in both smaller and larger cutoff scenarios.

# Continuous structure validation

We validated the consistency of the two clusters’ corresponding continuous scores in all IBD cohorts, non-IBD, and healthy control samples, as well as a randomly permuted mock study (as a negative control). The reproducibility of each continuous score within a study was defined as the maximum absolute cosine coefficient between the score’s consensus loading (as provided by MMUPHin_Continuous) and the top three principal component loadings discovered independently within that study. Note that the number of top principal components considered here was set to a fixed value (three) instead of based on a percent variance cutoff as in MMUPHin_Continuous. This is because in the two identified clusters in Fig. 5c, the latest included node was PC3. The randomly permuted study consisted of 473 samples (median validation data sets sample size) randomly selected from the entire meta-analysis collection, but each sample’s microbial abundance was independently permuted across features. This was to simulate a “negative control” dataset where there should be no continuous population structures.