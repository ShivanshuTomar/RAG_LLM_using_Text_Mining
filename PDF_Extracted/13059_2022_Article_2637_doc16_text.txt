# Abbas-Egbariya et al. Genome Biology (2022) 23:61

# Identification of shared (“non‑specific”) ASVs

This modified Bray-Curtis distance is similar to the classic Bray-Curtis distance, but calculated only on ASVs present in both samples. We opted for this modified Bray-Curtis metric to reduce the effect of the different disease cohorts (i.e., different populations/extraction protocols etc.) that can lead to the lack of observations of some ASVs in specific cohorts, therefore prohibiting the determination of the NRMD for the ASV in the specific cohort.

A distance matrix for all disease cohort pairs was calculated using this modified Bray-Curtis metric. This matrix was then used for the generation of a PCoA depicting disease cohort similarity using qiime2.

Non-specific ASVs are expected to share the same behavior (i.e., higher in cases or lower in cases) across multiple diseases, whereas for ASVs not associated with a non-specific disease response (the null hypothesis), the direction of change (higher in cases or lower in cases) is expected to follow a 0.5/0.5 binomial distribution. We therefore tested the direction of the effect size (i.e., higher (positive NRMD) or lower (negative NRMD) in cases compared to controls for the given disease cohort) and identified for ASVs whose effect size direction significantly differed from 0.5/0.5 binomial (i.e., ASVs that are higher (or lower) in cases compared to controls in a significant number of different diseases). This was implemented by using a two-sided binomial test (p = 0.5) on the sign of the NRMD in the different disease cohorts (only on disease cohorts where the ASV was present), followed by Benjamini-Hochberg FDR control (FDR < 0.1). To prevent bias introduced by diseases represented in multiple disease cohorts, all disease cohorts with the same disease were aggregated to a single entry (prior to the binomial test) with the NRMD defined as the mean of the NRMD of all cohorts with the same disease. The analysis was performed only on ASVs present in at least 4 disease cohorts.

NRMD results validation using additional metrics: NRMD is calculated separately for each disease cohort, and since it is rank based, it should be relatively robust to the number of reads per sample. In order to validate the results obtained using NRMD, we additionally tested for non-specific bacteria using two additional metrics: rarified NRMD and LEFSE-based LDA [38]. Following these additional effect size calculations, we identified the set of non-specific bacteria as described previously (see specific implementation details below). Since significance depends on the p-value, which is highly variable even between replicates [63], we also compared the results of LEFSE and rarified NRMD to the basic (non-rarified) NRMD by testing how the direction of change overlap between the two methods on the bacteria identified as non-specific following initial NRMD analysis as follows: for each bacteria identified as significantly non-specific (i.e., higher/lower in multiple disease cohorts compared to healthy controls), we calculated the mean of the LEFSE LDA or rarified NRMD over all disease cohorts and tested whether this mean effect size is positive (higher in disease) or negative (lower in disease). We then counted the number of bacteria for which the basic NRMD and the rarified NRMD (or LEFSE LDA) agree on the change direction. This indicates whether the same behavior (higher or lower in disease) is replicated using the different metrics used.